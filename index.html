<!--
  Clarity - A Text-Based Polyphonic Synthesizer

  Clarity is an innovative browser-based synthesizer that allows musicians and sound designers to
  create and manipulate audio using a text-driven interface. Rather than clicking through traditional
  knobs and sliders, users define their instrument by editing a structured text document that
  dynamically generates the user interface.

  The application features a split-pane design: the left pane contains a custom block-based text
  editor with syntax highlighting, while the right pane displays dynamically generated controls that
  update in real-time as you type. Users can create multiple oscillators with customizable parameters
  including waveform type (sine, square, sawtooth, triangle), octave offset, and volume. Each
  oscillator supports individual ADSR envelope controls for attack time, sustain level, and release time.

  Built on the Web Audio API, Clarity provides true polyphonic playback with a sophisticated
  polyphony manager that tracks multiple simultaneous notes. The synthesizer includes a master
  compressor with adjustable threshold, ratio, knee, attack, and release parameters to prevent
  clipping and shape the overall sound. Input methods include MIDI controller support and a virtual
  keyboard mapped to your computer keyboard. The interface features keyboard shortcuts for
  incrementing/decrementing values, adjusting text size and line spacing, and a command palette
  accessible via slash commands for quick actions.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>clarity</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hammersmith+One&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <!-- Left Pane: Text Editor -->
    <div class="left-pane">
      <div class="pane-header">clarity.instrument</div>
      <div id="parameters"></div>
    </div>

    <!-- Middle Pane: Instrument Controls -->
    <div class="middle-pane">
      <div class="pane-header">instrument panel</div>
      <!-- Dynamic oscillator/component sections generated from text -->
      <div id="oscillators-container"></div>
    </div>

    <!-- Right Pane: Visualizer & Input -->
    <div class="right-pane">
      <!-- Audio Visualizer -->
      <div id="waveform-container" class="waveform-container">
        <canvas id="waveform-canvas"></canvas>
      </div>

      <!-- Note Display -->
      <div id="note-display" class="note-display">
        <span id="note-display-text">--</span>
      </div>

      <!-- Virtual Keyboard Panel -->
      <div class="controls-section keyboard-panel">
        <div id="virtual-keyboard" tabindex="0">
          <div class="keyboard-hint">Click here, then use keyboard to play</div>
          <div class="keyboard-layout">
            <div class="keyboard-row">
              <span class="key-label" data-key="1">1</span>
              <span class="key-label" data-key="2">2</span>
              <span class="key-label" data-key="3">3</span>
              <span class="key-label" data-key="4">4</span>
              <span class="key-label" data-key="5">5</span>
              <span class="key-label" data-key="6">6</span>
              <span class="key-label" data-key="7">7</span>
              <span class="key-label" data-key="8">8</span>
              <span class="key-label" data-key="9">9</span>
              <span class="key-label" data-key="0">0</span>
            </div>
            <div class="keyboard-row">
              <span class="key-label" data-key="q">Q</span>
              <span class="key-label" data-key="w">W</span>
              <span class="key-label" data-key="e">E</span>
              <span class="key-label" data-key="r">R</span>
              <span class="key-label" data-key="t">T</span>
              <span class="key-label" data-key="y">Y</span>
              <span class="key-label" data-key="u">U</span>
              <span class="key-label" data-key="i">I</span>
              <span class="key-label" data-key="o">O</span>
              <span class="key-label" data-key="p">P</span>
            </div>
            <div class="keyboard-row">
              <span class="key-label" data-key="a">A</span>
              <span class="key-label" data-key="s">S</span>
              <span class="key-label" data-key="d">D</span>
              <span class="key-label" data-key="f">F</span>
              <span class="key-label" data-key="g">G</span>
              <span class="key-label" data-key="h">H</span>
              <span class="key-label" data-key="j">J</span>
              <span class="key-label" data-key="k">K</span>
              <span class="key-label" data-key="l">L</span>
              <span class="key-label" data-key=";">;</span>
            </div>
            <div class="keyboard-row">
              <span class="key-label" data-key="z">Z</span>
              <span class="key-label" data-key="x">X</span>
              <span class="key-label" data-key="c">C</span>
              <span class="key-label" data-key="v">V</span>
              <span class="key-label" data-key="b">B</span>
              <span class="key-label" data-key="n">N</span>
              <span class="key-label" data-key="m">M</span>
              <span class="key-label" data-key=",">,</span>
              <span class="key-label" data-key=".">.</span>
              <span class="key-label" data-key="/">/</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Hidden template sections (kept for backwards compatibility but not used) -->
      <div class="controls-section hidden" id="osc1-section">
        <h2>Oscillator 1</h2>

        <div class="slider-container">
          <label for="osc1-wave">Wave</label>
          <select id="osc1-wave">
            <option value="sine">Sine</option>
            <option value="square">Square</option>
            <option value="sawtooth">Sawtooth</option>
            <option value="triangle">Triangle</option>
          </select>
        </div>

        <div class="slider-container">
          <label for="osc1-octave">Octave</label>
          <input type="range" id="osc1-octave" min="-2" max="2" step="1" value="0">
        </div>

        <div class="slider-container">
          <label for="osc1-volume">Volume</label>
          <input type="range" id="osc1-volume" min="0" max="100" step="1" value="50">
        </div>
      </div>

      <div class="controls-section hidden" id="osc2-section">
        <h2>Oscillator 2</h2>

        <div class="slider-container">
          <label for="osc2-wave">Wave</label>
          <select id="osc2-wave">
            <option value="sine">Sine</option>
            <option value="square">Square</option>
            <option value="sawtooth">Sawtooth</option>
            <option value="triangle">Triangle</option>
          </select>
        </div>

        <div class="slider-container">
          <label for="osc2-octave">Octave</label>
          <input type="range" id="osc2-octave" min="-2" max="2" step="1" value="1">
        </div>

        <div class="slider-container">
          <label for="osc2-volume">Volume</label>
          <input type="range" id="osc2-volume" min="0" max="100" step="1" value="30">
        </div>
      </div>

      <div class="controls-section hidden" id="osc3-section">
        <h2>Oscillator 3</h2>

        <div class="slider-container">
          <label for="osc3-wave">Wave</label>
          <select id="osc3-wave">
            <option value="sine">Sine</option>
            <option value="square">Square</option>
            <option value="sawtooth">Sawtooth</option>
            <option value="triangle">Triangle</option>
          </select>
        </div>

        <div class="slider-container">
          <label for="osc3-octave">Octave</label>
          <input type="range" id="osc3-octave" min="-2" max="2" step="1" value="-1">
        </div>

        <div class="slider-container">
          <label for="osc3-volume">Volume</label>
          <input type="range" id="osc3-volume" min="0" max="100" step="1" value="20">
        </div>
      </div>

      <!-- All UI sections are generated dynamically from the document -->
    </div>
  </div>

  <!-- Command Modal -->
  <div id="command-modal" class="hidden">
    <input type="text" id="command-search" placeholder="Search commands..." autocomplete="off">
    <div id="command-list"></div>
  </div>

  <script src="chords.js"></script>
  <script src="variables.js"></script>
  <!-- New architecture files -->
  <script src="schemas.js"></script>
  <script src="instance-store.js"></script>
  <script src="parser.js"></script>
  <script src="audio-engine.js"></script>
  <script src="ui-generator.js"></script>
  <script src="visualizer.js"></script>
  <!-- Main application script -->
  <script src="script.js"></script>
</body>
</html>
